package com.github.harmishlakhani.KafkaPOC;

import kafka.javaapi.producer.Producer;
import kafka.producer.KeyedMessage;
import kafka.producer.ProducerConfig;

import java.util.Properties;

public class SimpleProducer {
    private static Producer<Integer, String> producer;
    private final Properties properties = new Properties();

    public SimpleProducer() {
        properties.put("metadata.broker.list", "172.16.43.86:9092");
        properties.put("serializer.class", "kafka.serializer.StringEncoder");
        properties.put("request.required.acks", "1");
        producer = new Producer<>(new ProducerConfig(properties));
    }

    public static void main(String[] args) {
        new SimpleProducer();
        String topic = "FLIGHT-NAV-PUSH";
        String msg = "<Sync__Web__Slx><Action><Field Name=\"Function\">Createbooking</Field></Action><QueryHeader><Field Name=\"Online Query\">1</Field><Field Name=\"E-Mail ID\">harmish.lakhani@gmail.com</Field><Field Name=\"Booking Status\">2</Field><Field Name=\"First Name\">BALACHANDRAN</Field><Field Name=\"No_\">NF2261280895961H</Field><Field Name=\"Document Date\">11/24/2016 12:00:00 AM</Field><Field Name=\"Phone No_\">9880633084</Field><Field Name=\"Document Time\">1/1/1754 3:56:43 AM</Field><Field Name=\"Last Name\">CHANDRASEKHARAN</Field><Field Name=\"Document Type\">1</Field><Field Name=\"Business Type\">1</Field><Field Name=\"Ship-to Country\">India</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"GDS Type\">1</Field><Field Name=\"Bill-to Country\">India</Field><Field Name=\"Mobile No_\">9880633084</Field><Field Name=\"Booking Sub Status\">-1</Field></QueryHeader><QueryLinePassenger><Field Name=\"Passenger\"><Field Name=\"Line No_\">10000</Field><Field Name=\"WebSite Data\">1</Field><Field Name=\"Gender\">1</Field><Field Name=\"Title\">1</Field><Field Name=\"Last Name\">CHANDRASEKHARAN</Field><Field Name=\"Document Type\">1</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"First Name\">BALACHANDRAN</Field><Field Name=\"Passenger Type\">0</Field><Field Name=\"PNR No_\">Failed</Field><Field Name=\"PNR Ref_ Id_\">FLT261210114689561</Field><Field Name=\"Pax Ref_ Id_\">10000</Field></Field></QueryLinePassenger><QueryLineAir><Field Name=\"Air\"><Field Name=\"Arrival Date\">11/26/2016 12:00:00 AM</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"PNR No_\">Failed</Field><Field Name=\"Departure Date\">11/26/2016 12:00:00 AM</Field><Field Name=\"Departure Time\">1/1/1754 12:35:00 PM</Field><Field Name=\"Class\">N</Field><Field Name=\"WebSite Data\">1</Field><Field Name=\"Travel Class\">1</Field><Field Name=\"Flight No_\">679/ 4217</Field><Field Name=\"Line No_\">10000</Field><Field Name=\"Document Type\">1</Field><Field Name=\"From City\">DED</Field><Field Name=\"No_ of Stops\">1</Field><Field Name=\"Offered Airline\">6E</Field><Field Name=\"Arrival Time\">1/1/1754 7:20:00 PM</Field><Field Name=\"PNR Ref_ Id_\">FLT261210114689561</Field><Field Name=\"To City\">TRV</Field><Field Name=\"Cancelled\">0</Field><Field Name=\"Family Sales Order No_\">O</Field><Field Name=\"Personal Sales Order No_\">DED-TRV</Field></Field></QueryLineAir><QueryLineDifferentialCancellationPenalty><Field Name=\"SegmentList\"><Field Name=\"Line No_\">10000</Field><Field Name=\"Adult\"><Field Name=\"DifferentialPenaltyList\"><Field Name=\"To TimeWindow\">8760</Field><Field Name=\"From TimeWindow\">720</Field><Field Name=\"Cancellation MarkUp\">300.0</Field><Field Name=\"Cancellation penalty\">13259.0</Field><Field Name=\"Date Change MarkUp\">300.0</Field><Field Name=\"Date Change Penalty\">13259.0</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Baggage Allowance\">15</Field><Field Name=\"Non Refundable\">1</Field><Field Name=\"Non Changeable\">1</Field><Field Name=\"Waiver Amount\">13258.100000000002</Field><Field Name=\"Convenience Fee\">1</Field><Field Name=\"Partial Cancellation Allowed\">No</Field></Field><Field Name=\"DifferentialPenaltyList\"><Field Name=\"To TimeWindow\">720</Field><Field Name=\"From TimeWindow\">168</Field><Field Name=\"Cancellation MarkUp\">300.0</Field><Field Name=\"Cancellation penalty\">13259.0</Field><Field Name=\"Date Change MarkUp\">300.0</Field><Field Name=\"Date Change Penalty\">13259.0</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Baggage Allowance\">15</Field><Field Name=\"Non Refundable\">1</Field><Field Name=\"Non Changeable\">1</Field><Field Name=\"Waiver Amount\">13258.100000000002</Field><Field Name=\"Convenience Fee\">1</Field><Field Name=\"Partial Cancellation Allowed\">No</Field></Field><Field Name=\"DifferentialPenaltyList\"><Field Name=\"To TimeWindow\">168</Field><Field Name=\"From TimeWindow\">48</Field><Field Name=\"Cancellation MarkUp\">300.0</Field><Field Name=\"Cancellation penalty\">13259.0</Field><Field Name=\"Date Change MarkUp\">300.0</Field><Field Name=\"Date Change Penalty\">13259.0</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Baggage Allowance\">15</Field><Field Name=\"Non Refundable\">1</Field><Field Name=\"Non Changeable\">1</Field><Field Name=\"Waiver Amount\">13258.100000000002</Field><Field Name=\"Convenience Fee\">1</Field><Field Name=\"Partial Cancellation Allowed\">No</Field></Field><Field Name=\"DifferentialPenaltyList\"><Field Name=\"To TimeWindow\">48</Field><Field Name=\"From TimeWindow\">4</Field><Field Name=\"Cancellation MarkUp\">300.0</Field><Field Name=\"Cancellation penalty\">13259.0</Field><Field Name=\"Date Change MarkUp\">300.0</Field><Field Name=\"Date Change Penalty\">13259.0</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Baggage Allowance\">15</Field><Field Name=\"Non Refundable\">1</Field><Field Name=\"Non Changeable\">1</Field><Field Name=\"Waiver Amount\">0.0</Field><Field Name=\"Convenience Fee\">0</Field><Field Name=\"Partial Cancellation Allowed\">No</Field></Field></Field></Field></QueryLineDifferentialCancellationPenalty><QueryLineFareAir><Field Name=\"FareAir\"><Field Name=\"Airline Ref_ID\">10000</Field><Field Name=\"Fare Basis Code\">N0IP679/ 4217</Field><Field Name=\"Product Type\">R</Field><Field Name=\"RBD\">N</Field><Field Name=\"Pax Type\">0</Field></Field></QueryLineFareAir><QueryLineFare><Field Name=\"Fare\"><Field Name=\"Non Refundable (BD)\">0</Field><Field Name=\"Date Change Not Allowed (AD)\">1</Field><Field Name=\"Discount Amount\">0.0</Field><Field Name=\"Date Change Penalty (AD)\">0</Field><Field Name=\"Cancellation Penalty (BD)\">13259.0</Field><Field Name=\"Base Amount\">11155.00</Field><Field Name=\"Document Type\">1</Field><Field Name=\"PNR No_\">Failed</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Published\">1</Field><Field Name=\"Tax Amount\">1730.00</Field><Field Name=\"GST Flag\">N</Field><Field Name=\"Passenger Type\">0</Field><Field Name=\"Airline Code\">6E</Field><Field Name=\"Passenger\">1</Field><Field Name=\"Fixed Commission Amount\">0.0</Field><Field Name=\"Is GST on Base\">N</Field><Field Name=\"Cancellation Markup (AD)\">300.0</Field><Field Name=\"Line No_\">10000</Field><Field Name=\"Web Tax Amount\">1730.00</Field><Field Name=\"Date Change Not Allowed (BD)\">0</Field><Field Name=\"Cancellation Penalty (AD)\">0</Field><Field Name=\"WebSite Data\">1</Field><Field Name=\"Segment\">1</Field><Field Name=\"GDS Fare\">11155.00</Field><Field Name=\"Date Change Markup (BD)\">300.0</Field><Field Name=\"To City\">TRV</Field><Field Name=\"Cancellation Markup (BD)\">300.0</Field><Field Name=\"Non Refundable (AD)\">1</Field><Field Name=\"Service Charge\">0.0</Field><Field Name=\"Date Change Markup (AD)\">300.0</Field><Field Name=\"No_ of Passengers\">1</Field><Field Name=\"From City\">DED</Field><Field Name=\"Fare Basis Code\">N0IP679/ 4217</Field><Field Name=\"Date Change Penalty (BD)\">13259.0</Field><Field Name=\"Popup Message\">R</Field></Field></QueryLineFare><PaymentCard><Field Name=\"Payment\"><Field Name=\"Nature of Payment\">0</Field><Field Name=\"Approval Date\">11/24/2016 12:00:00 AM</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"Surcharge Amount\">0.0</Field><Field Name=\"PGREFERENCEID\">4799400416336175504023</Field><Field Name=\"PGBank_ID\">HDFC Bank</Field><Field Name=\"Payment Gateway Code\">HDFCCYBS3P</Field><Field Name=\"Line No_\">10000</Field><Field Name=\"Document Type\">1</Field><Field Name=\"Amount\">14358.0</Field><Field Name=\"Approval Time\">11/24/2016 3:56:43 AM</Field><Field Name=\"IMINT Card No_\">9401159258934108</Field><Field Name=\"IsEncrypted\">1</Field><Field Name=\"Transaction Time\">11/24/2016 3:56:43 AM</Field><Field Name=\"Transaction Date\">11/24/2016 12:00:00 AM</Field><Field Name=\"Card Holder Name\">Ankit Kumar Monga</Field><Field Name=\"Card No_\">514834XXXXXX8725</Field><Field Name=\"Online Payment\">1</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"Approval Code\">958025</Field><Field Name=\"PGRRNO\"/><Field Name=\"Payment ID\">NF2261280895961HC01</Field></Field></PaymentCard><QueryLineInsurance><Field Name=\"Insurance\"><Field Name=\"Line No_\">10000</Field><Field Name=\"Policy No_\">DUMMY</Field><Field Name=\"First Name\">Balachandran</Field><Field Name=\"Temp PolicyNo\">1</Field><Field Name=\"Provider\">ADKV</Field><Field Name=\"Policy Issuance Date\">11/26/2016 12:00:00 AM</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"Document Type\">1</Field><Field Name=\"Document Date\">11/24/2016 12:00:00 AM</Field><Field Name=\"WebSite Data\">1</Field><Field Name=\"Last Name\">Chandrasekharan</Field><Field Name=\"Base Amount\">249</Field><Field Name=\"Date of Birth\">11/24/1981 12:00:00 AM</Field></Field></QueryLineInsurance><SegmentPassengerRelation><Field Name=\"PassengerRelation\"><Field Name=\"Passenger Name\">BALACHANDRAN CHANDRASEKHARAN</Field><Field Name=\"Line No_\">10000</Field><Field Name=\"PNR No_\">Failed</Field><Field Name=\"From City\">DED</Field><Field Name=\"Document Type\">1</Field><Field Name=\"Request Type\">MEALS</Field><Field Name=\"Amount\">600.0</Field><Field Name=\"Passenger Line No_\">10000</Field><Field Name=\"Document No_\">NF2261280895961H</Field><Field Name=\"UserID\">ADT</Field><Field Name=\"To City\">TRV</Field><Field Name=\"Airline Code\">6E</Field><Field Name=\"Request Type Value\">Non Veg Meal,Non Veg Meal</Field><Field Name=\"Segment Line No_\">10000</Field><Field Name=\"Non Refundable\">0</Field><Field Name=\"Fare Line No_\">10000</Field><Field Name=\"Departure DateTime\">11/26/2016 12:35:00 PM</Field></Field></SegmentPassengerRelation><Rule><PaymentCard><Field Name=\"Payment Card\"><Field Name=\"Card Holder LName\"/><Field Name=\"Mode\">Debit Card</Field><Field Name=\"Card Holder FName\"/></Field></PaymentCard><QueryHeader><Field Name=\"Query Header\"><Field Name=\"ProductCode\">F01</Field><Field Name=\"ICSU_BranchCode\"/><Field Name=\"CCNumber\">514834XXXXXX8725</Field><Field Name=\"FBK_NAV_STAT\">N</Field><Field Name=\"PostSalesPromoCode\"/></Field></QueryHeader><BookingPromotions><Field Name=\"Booking Promotion\"><Field Name=\"FBK_DONATION\">0</Field></Field></BookingPromotions><QueryLineFare><Field Name=\"Query Line Fare\"><Field Name=\"PNRNo\">Failed</Field><Field Name=\"PNR_SupplierID\"/></Field></QueryLineFare><QueryLineAir><Field Name=\"Query Line Air\"><Field Name=\"Line No_\">10000</Field><Field Name=\"CancellationAssured\">1</Field></Field></QueryLineAir><WalletDetails><RefundDetails><Field Name=\"RefundAdjustment\">4</Field><Field Name=\"RefundTranID\">63996888</Field><Field Name=\"WalletNo\">WL201411011636865</Field></RefundDetails></WalletDetails></Rule><VendorMarkupDiscount><Field Name=\"Document Type\">1</Field><Field Name=\"No_\">NF2261280895961H</Field><Field Name=\"Document Date\">11/24/2016 12:00:00 AM</Field><Field Name=\"Charge Type\">0</Field><Field Name=\"Charge Level\">0</Field><Field Name=\"MMT_Service_Fee\">225.0</Field><Field Name=\"Currency Code\">INR</Field><Field Name=\"CancellationAssurance_Amt\">399.0</Field></VendorMarkupDiscount></Sync__Web__Slx> ";
        KeyedMessage<Integer, String> data = new KeyedMessage<>(topic, msg);
        producer.send(data);
        producer.close();
        System.out.println("Published following message : " + msg);
    }
}